<!doctype html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Harmoneasy</title>
  <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
  <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
  <link rel="shortcut icon" href="/favicon.ico" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <meta name="apple-mobile-web-app-title" content="Harmoneasy" />
  <link rel="manifest" href="/site.webmanifest" />
</head>

<body>

  <header>
    
    <a class="backlink" href="/">
      <img class="logo" src="/source/assets/logos/harmoneasy.svg" alt=""> 
      <h1>Harmoneasy</h1>
      <h2>Putting the Unity in Community</h2>
      <p aria-summary class="sr-only">Play with friends. Harmoneasy is a web-based MIDI sequencer that allows you to play with friends in real-time and your music will be transformed in many ways to improve it, from synchronising the timing to transposing into key.</p>
    </a>

    <menu class="header-controls">

      <label id="tempo-control" class="controls">
        Tempo:
        <input id="tempo" type="range" min=10 max=303>
        <output id="bpm"></output> BPM
      </label>

      <label id="volume-control" class="controls">
        Volume:
        <input id="volume" type="range" min=0 max=100 value=100>
        <output id="volume-output">100</output> %
      </label>

      <div class="device-buttons">
        <button type="button" id="btn-random-timbre">Random Timbre</button>
        <button type="button" id="btn-connect-to-ble">Connect Bluetooth</button>
        <button type="button" id="btn-toggle-webmidi">Connect WebMIDI</button>
        <button type="button" id="btn-kill-switch" class="kill-switch primary">Panic</button>
        <button type="button" id="btn-reset" class="primary">Reset</button>
      </div>

    </menu>

  </header>

  <div id="timer-bar">
    <strong>TIMER</strong>
    <time id="clock">...</time>
  </div>

  <menu id="action-bar">
    <button class="primary" type="button" id="btn-midi-export">Export as MIDI file</button>
    <button type="button" id="btn-audiotool-export">Open in AudioTool</button>
    <button type="button" id="btn-opendaw-export">Open in OpenDAW</button>
  </menu>

  <!-- Sidebar for MIDI Events -->
  <aside id="sidebar">

    <header id="sidebar-header">
      <h4>MIDI Events</h4>
      <button id="sidebar-close"><span class="sr-only">close</span>&times;</button>
    </header>

    <div id="sidebar-content">
      <output id="midi-devices"></output>
      <output id="midi-input-commands"></output>
      <output id="midi-output-commands"></output>

      <div id="ble-manual-send-fieldset" hidden>
        <legend>Manual BLE Send</legend>

        <label for="midi-channel-selector">BLE MIDI Channel:
          <select id="midi-channel-selector">
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10</option>
            <option value="11">11</option>
            <option value="12">12</option>
            <option value="13">13</option>
            <option value="14">14</option>
            <option value="15">15</option>
            <option value="16">16</option>
          </select>
        </label>

        <label for="ble-manual-input">Manual BLE Send
          <input id="ble-manual-input" type="text" placeholder="Enter bytes e.g. 144,60,127">
        </label>

        <button type="button" id="btn-send-ble-manual">Send BLE</button>
      </div>
    </div>

  </aside>


  <main>

    <div id="graph"></div>
   
    <div id="keyboard-container">
      <canvas id="wallpaper" width="1920" height="1080"></canvas>
    </div>

  </main>

  <div id="export-overlay" class="export-overlay" hidden>
    <div class="export-overlay-content">
      <div class="spinner"></div>
      <h3>Exporting to AudioTool...</h3>
      <p>Please wait while we create your project</p>
    </div>
  </div>

  
  <dialog id="info-dialog" hidden>
    <h5>Information</h5>
    <pre id="info-message" class="selectable"></pre>
    <form action="/" onsubmit="return false">
      <button class="close-button" type="dialog">Close</button>
    </form>
  </dialog>

  <dialog id="error-dialog" hidden>
    <h5>Error</h5>
    <p id="error-message"></p>
    <p id="error-solution"></p>
    <form action="/" onsubmit="return false">
      <button class="close-button" type="dialog">Close</button>
    </form>
  </dialog>

  <script type="module" src="/source/index.ts"></script>
  
  <!-- Hidden form for backward compatibility -->
  <form id="options" style="display: none;">
    <fieldset id="midi-settings-fieldset"></fieldset>
    <fieldset id="midi-controls"></fieldset>
  </form>

</body>

</html>