<!doctype html>
<html lang="en">

<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>Harmoneasy</title>
	<link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
	<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
	<link rel="shortcut icon" href="/favicon.ico" />
	<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
	<meta name="apple-mobile-web-app-title" content="Harmoneasy" />
	<link rel="manifest" href="/site.webmanifest" />
</head>

<body>

	<header>

		<a class="backlink" href="/">
			<img class="logo" src="/source/assets/logos/harmoneasy.svg" alt="">
			<h1>Harmoneasy</h1>
			<h2>Putting the Unity in Community</h2>
			<p aria-summary class="sr-only">Play with friends. Harmoneasy is a web-based MIDI sequencer that allows you
				to play with friends in real-time and your music will be transformed in many ways to improve it, from
				synchronising the timing to transposing into key.
			</p>
		</a>

		<menu class="header-controls">

			<label id="tempo-control" class="controls">
				Tempo:
				<input id="tempo" type="range" min=10 max=303>
				<output id="bpm"></output> BPM
			</label>

			<label id="volume-control" class="controls">
				Volume:
				<input id="volume" type="range" min=0 max=100 value=100>
				<output id="volume-output">100</output> %
			</label>

			<div class="device-buttons">
				<button type="button" id="btn-random-timbre">Random Timbre</button>
				<button type="button" id="btn-connect-to-ble">Connect Bluetooth</button>
				<button type="button" id="btn-toggle-webmidi">Connect WebMIDI</button>
				<button type="button" id="btn-kill-switch" class="kill-switch primary">Panic</button>
			</div>

		</menu>

	</header>

	<main>
		<menu id="action-bar">
			<button class="primary" type="button" id="btn-import">Import</button>
			<button class="primary" type="button" id="btn-export">Export</button>
		</menu>

		<div id="graph"></div>
		<canvas id="note-visualiser" width="1080" height="512"></canvas>
		<!-- <song-explorer></song-explorer> -->
		<!-- <canvas id="song-explorer" width="1920" height="1080"></canvas> -->
	</main>

	<!-- Transport -->
	<div id="transport" aria-hide>
		<strong>Timer</strong>
		<time id="clock">...</time>
		<button type="button" id="btn-reset" class="icon">Reset</button>
	</div>

	<!-- Sidebars for MIDI Events -->
	<aside id="sidebar">

		<header id="sidebar-header">
			<h4>MIDI Events</h4>
			<button type="button" id="sidebar-close" class="btn-close">Hide MIDI Events</button>
		</header>

		<div id="sidebar-content">
			<output id="midi-devices"></output>
			<output id="midi-input-commands"></output>
			<output id="midi-output-commands"></output>

			<div id="ble-manual-send-fieldset" hidden>
				<legend>Manual BLE Send</legend>

				<label for="midi-channel-selector">BLE MIDI Channel:
					<select id="midi-channel-selector">
						<option value="1">1</option>
						<option value="2">2</option>
						<option value="3">3</option>
						<option value="4">4</option>
						<option value="5">5</option>
						<option value="6">6</option>
						<option value="7">7</option>
						<option value="8">8</option>
						<option value="9">9</option>
						<option value="10">10</option>
						<option value="11">11</option>
						<option value="12">12</option>
						<option value="13">13</option>
						<option value="14">14</option>
						<option value="15">15</option>
						<option value="16">16</option>
					</select>
				</label>

				<label for="ble-manual-input">Manual BLE Send
					<input id="ble-manual-input" type="text" placeholder="Enter bytes e.g. 144,60,127">
				</label>

				<button type="button" id="btn-send-ble-manual">Send BLE</button>
			</div>
		</div>

	</aside>

	<!-- Overlays -->
	<dialog id="info-dialog" closedby="any" hidden aria-labelledby="info-dialog-title" aria-describedby="info-message">
		<header>
			<h5 id="info-dialog-title">Information</h5>
		</header>
		<pre id="info-message" class="selectable" role="status" aria-live="polite"></pre>
		<form method="dialog">
			<button class="btn-close" type="submit">
				Close
			</button>
		</form>
	</dialog>

	<dialog id="error-dialog" hidden closedby="any" aria-labelledby="error-dialog-title" aria-describedby="error-message">
		<header>
			<h5 id="error-dialog-title">Error</h5>
		</header>
		<div role="alert">
			<p id="error-message"></p>
			<p id="error-solution"></p>
		</div>
		<form method="dialog">
			<button class="btn-close" type="submit">
				Close
			</button>
		</form>
	</dialog>

	<dialog id="export-dialog" hidden closedby="any" aria-labelledby="export-dialog-title">
		<header>
			<h5 id="export-dialog-title">Export</h5>	
		</header>
		<menu id="export-options" class="export-menu">
			<button type="button" id="btn-audiotool-export" class="export-option">
				<img src="source/assets/logos/audiotool.svg" alt="AudioTool" class="logo-inline">
				Open in AudioTool
			</button>
			<button type="button" id="btn-opendaw-export" class="export-option">
				<img src="source/assets/logos/opendaw.svg" alt="OpenDAW" class="logo-inline">
				Open in OpenDAW
			</button>
			<hr>
			<button type="button" id="btn-midi-export" class="export-option">Export as MIDI file</button>
			<button type="button" id="btn-dawproject-export" class="export-option">Export as .dawProject</button>
			<button type="button" id="btn-midi-markdown-export" class="export-option">Export as Markdown</button>
			<button type="button" id="btn-musicxml-export" class="export-option">Export to MusicXML</button>
			<button type="button" id="btn-vexflow-export" class="export-option">Download Sheet Music</button>
		</menu>
		<form method="dialog">
			<button class="btn-close" type="submit">
				Close
			</button>
		</form>
	</dialog>

	<div id="export-overlay" class="export-overlay" hidden>
		<div class="export-overlay-content">
			<div class="spinner"></div>
			<h5>Exporting...</h5>
			<p>Please wait while we create your project</p>
		</div>
	</div>

	<script type="module" src="/source/index.ts"></script>

	<!-- Hidden form for backward compatibility -->
	<form id="options" style="display: none;">
		<fieldset id="midi-settings-fieldset"></fieldset>
		<fieldset id="midi-controls"></fieldset>
	</form>

</body>

</html>